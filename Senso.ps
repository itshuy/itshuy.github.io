# Define the product code and desired version

$productCode = "senso.cloud" 

$desiredVersion = "2023.12.11.0"



# Get the installed product details

$installedProduct = Get-WmiObject -Class Win32_Product -Filter "ProductID='$productCode'"



# Check if the installed version matches the desired version

if ($installedProduct.Version -ne $desiredVersion) {

    # Uninstall the current version if it doesn't match

    msiexec /x $installedProduct.UninstallString /quiet
	
	msiexec /i senso_client_x64.msi LIC=D3E-40B-F59 SITE=SCCPRO /qn /forcerestart

    # Write-Output "Uninstalled version: $($installedProduct.Version)"

} else {

    # Write-Output "Desired version is already installed."

}
